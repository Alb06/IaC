# Synchronisation vers GitHub
mirror_to_github:
  stage: sync
  image: alpine:latest
  timeout: 3m
  before_script:
    - *setup_ssh
  script:
    - echo "ðŸ”„ Synchronisation vers GitHub..."
    - git remote add mirror git@github.com:Alb06/IaC.git || true
    - git push mirror HEAD:main --force
    - echo "âœ… Synchronisation terminÃ©e"
  needs: []
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'
      when: always
  # tags:
  #   - terraform

# Synchronisation des issues
sync_issues_to_github:
  stage: sync
  image: python:3.11
  timeout: 3m
  before_script:
    - pip install requests
  script:
    - echo "ðŸ”„ Synchronisation des issues GitLab â†’ GitHub..."
    - python scripts/ci-cd/sync_issues.py
  needs: []
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'
      when: always
  # tags:
  #   - terraform